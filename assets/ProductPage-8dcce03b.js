import{c as U,g as X,i as Y,e as J,n as D,a as O,S as j,b as q,P as K}from"./PopularProducts-33d6ee36.js";import{d as H,i as k,o as I,c as B,f as C,w as M,u as w,F as L,j as R,e as T,k as Q,l as W,m as Z,n as ee,t as V,q as te,_ as se}from"./index-5083176d.js";import{B as ie}from"./BaseCounter-d1ac017d.js";import{n as ae}from"./numberFormatter-3e9f9747.js";function F(S){let{swiper:e,extendParams:x,on:d,emit:v}=S;x({navigation:{nextEl:null,prevEl:null,hideOnClick:!1,disabledClass:"swiper-button-disabled",hiddenClass:"swiper-button-hidden",lockClass:"swiper-button-lock",navigationDisabledClass:"swiper-navigation-disabled"}}),e.navigation={nextEl:null,prevEl:null};const u=s=>(Array.isArray(s)||(s=[s].filter(i=>!!i)),s);function E(s){let i;return s&&typeof s=="string"&&e.isElement&&(i=e.el.querySelector(s),i)?i:(s&&(typeof s=="string"&&(i=[...document.querySelectorAll(s)]),e.params.uniqueNavElements&&typeof s=="string"&&i.length>1&&e.el.querySelectorAll(s).length===1&&(i=e.el.querySelector(s))),s&&!i?s:i)}function h(s,i){const a=e.params.navigation;s=u(s),s.forEach(o=>{o&&(o.classList[i?"add":"remove"](...a.disabledClass.split(" ")),o.tagName==="BUTTON"&&(o.disabled=i),e.params.watchOverflow&&e.enabled&&o.classList[e.isLocked?"add":"remove"](a.lockClass))})}function m(){const{nextEl:s,prevEl:i}=e.navigation;if(e.params.loop){h(i,!1),h(s,!1);return}h(i,e.isBeginning&&!e.params.rewind),h(s,e.isEnd&&!e.params.rewind)}function r(s){s.preventDefault(),!(e.isBeginning&&!e.params.loop&&!e.params.rewind)&&(e.slidePrev(),v("navigationPrev"))}function t(s){s.preventDefault(),!(e.isEnd&&!e.params.loop&&!e.params.rewind)&&(e.slideNext(),v("navigationNext"))}function l(){const s=e.params.navigation;if(e.params.navigation=U(e,e.originalParams.navigation,e.params.navigation,{nextEl:"swiper-button-next",prevEl:"swiper-button-prev"}),!(s.nextEl||s.prevEl))return;let i=E(s.nextEl),a=E(s.prevEl);Object.assign(e.navigation,{nextEl:i,prevEl:a}),i=u(i),a=u(a);const o=(n,b)=>{n&&n.addEventListener("click",b==="next"?t:r),!e.enabled&&n&&n.classList.add(...s.lockClass.split(" "))};i.forEach(n=>o(n,"next")),a.forEach(n=>o(n,"prev"))}function p(){let{nextEl:s,prevEl:i}=e.navigation;s=u(s),i=u(i);const a=(o,n)=>{o.removeEventListener("click",n==="next"?t:r),o.classList.remove(...e.params.navigation.disabledClass.split(" "))};s.forEach(o=>a(o,"next")),i.forEach(o=>a(o,"prev"))}d("init",()=>{e.params.navigation.enabled===!1?f():(l(),m())}),d("toEdge fromEdge lock unlock",()=>{m()}),d("destroy",()=>{p()}),d("enable disable",()=>{let{nextEl:s,prevEl:i}=e.navigation;s=u(s),i=u(i),[...s,...i].filter(a=>!!a).forEach(a=>a.classList[e.enabled?"remove":"add"](e.params.navigation.lockClass))}),d("click",(s,i)=>{let{nextEl:a,prevEl:o}=e.navigation;a=u(a),o=u(o);const n=i.target;if(e.params.navigation.hideOnClick&&!o.includes(n)&&!a.includes(n)){if(e.pagination&&e.params.pagination&&e.params.pagination.clickable&&(e.pagination.el===n||e.pagination.el.contains(n)))return;let b;a.length?b=a[0].classList.contains(e.params.navigation.hiddenClass):o.length&&(b=o[0].classList.contains(e.params.navigation.hiddenClass)),v(b===!0?"navigationShow":"navigationHide"),[...a,...o].filter(y=>!!y).forEach(y=>y.classList.toggle(e.params.navigation.hiddenClass))}});const c=()=>{e.el.classList.remove(...e.params.navigation.navigationDisabledClass.split(" ")),l(),m()},f=()=>{e.el.classList.add(...e.params.navigation.navigationDisabledClass.split(" ")),p()};Object.assign(e.navigation,{enable:c,disable:f,update:m,init:l,destroy:p})}function $(S){let{swiper:e,extendParams:x,on:d}=S;x({thumbs:{swiper:null,multipleActiveThumbs:!0,autoScrollOffset:0,slideThumbActiveClass:"swiper-slide-thumb-active",thumbsContainerClass:"swiper-thumbs"}});let v=!1,u=!1;e.thumbs={swiper:null};function E(){const r=e.thumbs.swiper;if(!r||r.destroyed)return;const t=r.clickedIndex,l=r.clickedSlide;if(l&&l.classList.contains(e.params.thumbs.slideThumbActiveClass)||typeof t>"u"||t===null)return;let p;r.params.loop?p=parseInt(r.clickedSlide.getAttribute("data-swiper-slide-index"),10):p=t,e.params.loop?e.slideToLoop(p):e.slideTo(p)}function h(){const{thumbs:r}=e.params;if(v)return!1;v=!0;const t=e.constructor;if(r.swiper instanceof t)e.thumbs.swiper=r.swiper,Object.assign(e.thumbs.swiper.originalParams,{watchSlidesProgress:!0,slideToClickedSlide:!1}),Object.assign(e.thumbs.swiper.params,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper.update();else if(Y(r.swiper)){const l=Object.assign({},r.swiper);Object.assign(l,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper=new t(l),u=!0}return e.thumbs.swiper.el.classList.add(e.params.thumbs.thumbsContainerClass),e.thumbs.swiper.on("tap",E),!0}function m(r){const t=e.thumbs.swiper;if(!t||t.destroyed)return;const l=t.params.slidesPerView==="auto"?t.slidesPerViewDynamic():t.params.slidesPerView;let p=1;const c=e.params.thumbs.slideThumbActiveClass;if(e.params.slidesPerView>1&&!e.params.centeredSlides&&(p=e.params.slidesPerView),e.params.thumbs.multipleActiveThumbs||(p=1),p=Math.floor(p),t.slides.forEach(i=>i.classList.remove(c)),t.params.loop||t.params.virtual&&t.params.virtual.enabled)for(let i=0;i<p;i+=1)J(t.slidesEl,`[data-swiper-slide-index="${e.realIndex+i}"]`).forEach(a=>{a.classList.add(c)});else for(let i=0;i<p;i+=1)t.slides[e.realIndex+i]&&t.slides[e.realIndex+i].classList.add(c);const f=e.params.thumbs.autoScrollOffset,s=f&&!t.params.loop;if(e.realIndex!==t.realIndex||s){const i=t.activeIndex;let a,o;if(t.params.loop){const n=t.slides.filter(b=>b.getAttribute("data-swiper-slide-index")===`${e.realIndex}`)[0];a=t.slides.indexOf(n),o=e.activeIndex>e.previousIndex?"next":"prev"}else a=e.realIndex,o=a>e.previousIndex?"next":"prev";s&&(a+=o==="next"?f:-1*f),t.visibleSlidesIndexes&&t.visibleSlidesIndexes.indexOf(a)<0&&(t.params.centeredSlides?a>i?a=a-Math.floor(l/2)+1:a=a+Math.floor(l/2)-1:a>i&&t.params.slidesPerGroup,t.slideTo(a,r?0:void 0))}}d("beforeInit",()=>{const{thumbs:r}=e.params;if(!(!r||!r.swiper))if(typeof r.swiper=="string"||r.swiper instanceof HTMLElement){const t=X(),l=()=>{const c=typeof r.swiper=="string"?t.querySelector(r.swiper):r.swiper;if(c&&c.swiper)r.swiper=c.swiper,h(),m(!0);else if(c){const f=s=>{r.swiper=s.detail[0],c.removeEventListener("init",f),h(),m(!0),r.swiper.update(),e.update()};c.addEventListener("init",f)}return c},p=()=>{if(e.destroyed)return;l()||requestAnimationFrame(p)};requestAnimationFrame(p)}else h(),m(!0)}),d("slideChange update resize observerUpdate",()=>{m()}),d("setTransition",(r,t)=>{const l=e.thumbs.swiper;!l||l.destroyed||l.setTransition(t)}),d("beforeDestroy",()=>{const r=e.thumbs.swiper;!r||r.destroyed||u&&r.destroy()}),Object.assign(e.thumbs,{init:h,update:m})}function z(S){let{swiper:e,extendParams:x,emit:d,once:v}=S;x({freeMode:{enabled:!1,momentum:!0,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,momentumVelocityRatio:1,sticky:!1,minimumVelocity:.02}});function u(){if(e.params.cssMode)return;const m=e.getTranslate();e.setTranslate(m),e.setTransition(0),e.touchEventsData.velocities.length=0,e.freeMode.onTouchEnd({currentPos:e.rtl?e.translate:-e.translate})}function E(){if(e.params.cssMode)return;const{touchEventsData:m,touches:r}=e;m.velocities.length===0&&m.velocities.push({position:r[e.isHorizontal()?"startX":"startY"],time:m.touchStartTime}),m.velocities.push({position:r[e.isHorizontal()?"currentX":"currentY"],time:D()})}function h(m){let{currentPos:r}=m;if(e.params.cssMode)return;const{params:t,wrapperEl:l,rtlTranslate:p,snapGrid:c,touchEventsData:f}=e,i=D()-f.touchStartTime;if(r<-e.minTranslate()){e.slideTo(e.activeIndex);return}if(r>-e.maxTranslate()){e.slides.length<c.length?e.slideTo(c.length-1):e.slideTo(e.slides.length-1);return}if(t.freeMode.momentum){if(f.velocities.length>1){const g=f.velocities.pop(),_=f.velocities.pop(),G=g.position-_.position,N=g.time-_.time;e.velocity=G/N,e.velocity/=2,Math.abs(e.velocity)<t.freeMode.minimumVelocity&&(e.velocity=0),(N>150||D()-g.time>300)&&(e.velocity=0)}else e.velocity=0;e.velocity*=t.freeMode.momentumVelocityRatio,f.velocities.length=0;let a=1e3*t.freeMode.momentumRatio;const o=e.velocity*a;let n=e.translate+o;p&&(n=-n);let b=!1,y;const P=Math.abs(e.velocity)*20*t.freeMode.momentumBounceRatio;let A;if(n<e.maxTranslate())t.freeMode.momentumBounce?(n+e.maxTranslate()<-P&&(n=e.maxTranslate()-P),y=e.maxTranslate(),b=!0,f.allowMomentumBounce=!0):n=e.maxTranslate(),t.loop&&t.centeredSlides&&(A=!0);else if(n>e.minTranslate())t.freeMode.momentumBounce?(n-e.minTranslate()>P&&(n=e.minTranslate()+P),y=e.minTranslate(),b=!0,f.allowMomentumBounce=!0):n=e.minTranslate(),t.loop&&t.centeredSlides&&(A=!0);else if(t.freeMode.sticky){let g;for(let _=0;_<c.length;_+=1)if(c[_]>-n){g=_;break}Math.abs(c[g]-n)<Math.abs(c[g-1]-n)||e.swipeDirection==="next"?n=c[g]:n=c[g-1],n=-n}if(A&&v("transitionEnd",()=>{e.loopFix()}),e.velocity!==0){if(p?a=Math.abs((-n-e.translate)/e.velocity):a=Math.abs((n-e.translate)/e.velocity),t.freeMode.sticky){const g=Math.abs((p?-n:n)-e.translate),_=e.slidesSizesGrid[e.activeIndex];g<_?a=t.speed:g<2*_?a=t.speed*1.5:a=t.speed*2.5}}else if(t.freeMode.sticky){e.slideToClosest();return}t.freeMode.momentumBounce&&b?(e.updateProgress(y),e.setTransition(a),e.setTranslate(n),e.transitionStart(!0,e.swipeDirection),e.animating=!0,O(l,()=>{!e||e.destroyed||!f.allowMomentumBounce||(d("momentumBounce"),e.setTransition(t.speed),setTimeout(()=>{e.setTranslate(y),O(l,()=>{!e||e.destroyed||e.transitionEnd()})},0))})):e.velocity?(d("_freeModeNoMomentumRelease"),e.updateProgress(n),e.setTransition(a),e.setTranslate(n),e.transitionStart(!0,e.swipeDirection),e.animating||(e.animating=!0,O(l,()=>{!e||e.destroyed||e.transitionEnd()}))):e.updateProgress(n),e.updateActiveIndex(),e.updateSlidesClasses()}else if(t.freeMode.sticky){e.slideToClosest();return}else t.freeMode&&d("_freeModeNoMomentumRelease");(!t.freeMode.momentum||i>=t.longSwipesMs)&&(e.updateProgress(),e.updateActiveIndex(),e.updateSlidesClasses())}Object.assign(e,{freeMode:{onTouchStart:u,onTouchMove:E,onTouchEnd:h}})}const ne=["src","alt"],re=["src","alt"],oe=H({__name:"ProductPageCarousel",props:{product:{}},setup(S){const e=k(),x=d=>{e.value=d};return(d,v)=>(I(),B(L,null,[C(w(q),{spaceBetween:10,navigation:!0,thumbs:{swiper:e.value},modules:[w(z),w(F),w($)],class:"product-swiper top-swiper"},{default:M(()=>[(I(),B(L,null,R(5,u=>C(w(j),{key:u,class:"product-slide main-img"},{default:M(()=>[T("img",{src:d.product.image,alt:d.product.title},null,8,ne)]),_:2},1024)),64))]),_:1},8,["thumbs","modules"]),C(w(q),{onSwiper:x,spaceBetween:10,slidesPerView:4,freeMode:!0,watchSlidesProgress:!0,modules:[w(z),w(F),w($)],class:"product-swiper"},{default:M(()=>[(I(),B(L,null,R(5,u=>C(w(j),{key:u,class:"product-slide"},{default:M(()=>[T("img",{src:d.product.image,alt:d.product.title},null,8,re)]),_:2},1024)),64))]),_:1},8,["modules"])],64))}});const le={class:"product-page__container container"},de={class:"product-page__left"},ce={class:"product-page__right"},ue={class:"product-page__title"},me={class:"product-page__price"},pe={class:"product-page__description"},fe={class:"product-page__btn-block"},ve=H({__name:"ProductPage",setup(S){const e=Q(),x=W(),d=k(!1),v=k({}),u=k(1),E=Z(()=>String(e.params.slug)),h=()=>{x.addProductToCart(v.value.id,u.value)},m=()=>{d.value=!0,te.getById(E.value).then(r=>v.value=r.data).then(()=>d.value=!1)};return ee([E],()=>{m()}),m(),(r,t)=>(I(),B(L,null,[T("div",le,[T("div",de,[C(oe,{product:v.value},null,8,["product"])]),T("div",ce,[T("h1",ue,V(v.value.title),1),T("span",me,V(w(ae)(v.value.price))+" ₽",1),T("p",pe,V(v.value.description),1),T("div",fe,[C(ie,{amount:u.value,"onUpdate:amount":t[0]||(t[0]=l=>u.value=l)},null,8,["amount"]),T("button",{class:"product-page__btn-add",onClick:t[1]||(t[1]=l=>h())}," Добавить в корзину ")])])]),C(K)],64))}});const _e=se(ve,[["__scopeId","data-v-d89e8238"]]);export{_e as default};
